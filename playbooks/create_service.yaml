---
- hosts: swarm_manager
  gather_facts: no
  tasks:
    - name: Create service in swarm
      shell: "docker service create --name {{swarm_service.name }} --replicas {{ swarm_service.replicas }} {{ swarm_service.container }} {{ swarm_service.command }}"
      become: yes

    - name: Checking currently running serices
      shell: "docker services ls"
      register: services_info
      become: yes

    - debug: var=services_info

    - name: Checking sevice details
      shell: "docker service inspect {{ swarm_service.name }}"
      register: service_details
      become: yes

    - debug: var=service_details

    - name: Checking sevice hosts
      shell: "docker service ps {{ swarm_service.name  }}"
      register: service_hosts
      become: yes

    - debug: var=service_hosts
